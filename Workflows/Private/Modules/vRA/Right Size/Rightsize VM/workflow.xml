<?xml version='1.0' encoding='UTF-8'?>
<workflow xmlns="http://vmware.com/vco/workflow" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xsi:schemaLocation="http://vmware.com/vco/workflow http://vmware.com/vco/workflow/Workflow-v4.xsd" root-name="item9" object-name="workflow:name=generic" id="398117b4-2637-4cdc-9c83-7be24aff9743" version="0.0.10" api-version="6.0.0" allowed-operations="evf" restartMode="1" resumeFromFailedMode="0">
  <display-name><![CDATA[Rightsize VM]]></display-name>
  <description><![CDATA[Changes the amount of RAM of a virtual machine.]]></description>
  <ref-types><![CDATA[(VC:VirtualMachine)]]></ref-types>
  <position y="99.95454545454544" x="45.0"/>
  <input>
    <param name="vm" type="VC:VirtualMachine">
      <description><![CDATA[Virtual machine on which to change the CPU number]]></description>
    </param>
    <param name="vcpu" type="number">
      <description><![CDATA[New vCPU number]]></description>
    </param>
    <param name="mem" type="number"/>
  </input>
  <attrib name="task" type="VC:Task" read-only="false">
    <value encoded="n"><![CDATA[__NULL__]]></value>
    <description><![CDATA[Task to await]]></description>
  </attrib>
  <attrib name="timeout" type="number" read-only="false">
    <value encoded="n"><![CDATA[2.0]]></value>
    <description><![CDATA[Timeout to wait before force power off [min]]]></description>
  </attrib>
  <attrib name="actionResult" type="VC:Task" read-only="false">
    <value encoded="n"><![CDATA[__NULL__]]></value>
  </attrib>
  <attrib name="errorCode" type="string" read-only="false">
    <value encoded="n"><![CDATA[]]></value>
  </attrib>
  <workflow-item name="item2" type="end" end-mode="0">
    <position y="99.95454545454544" x="1304.5"/>
  </workflow-item>
  <workflow-item name="item3" out-name="item6" type="task" script-module="com.vmware.library.vc.basic/vim3WaitTaskEnd">
    <display-name><![CDATA[vim3WaitTaskEnd]]></display-name>
    <script encoded="false"><![CDATA[//Auto generated script, cannot be modified !
actionResult = System.getModule("com.vmware.library.vc.basic").vim3WaitTaskEnd(task,progress,pollRate) ;]]></script>
    <in-binding>
      <bind name="task" type="VC:Task" export-name="task">
        <description><![CDATA[Task to Wait for]]></description>
      </bind>
      <bind name="progress" type="boolean" explicitly-not-bound="true">
        <description><![CDATA[Log progess while waiting for the task]]></description>
      </bind>
      <bind name="pollRate" type="number" explicitly-not-bound="true">
        <description><![CDATA[Polling rate for the task state [seconds]]]></description>
      </bind>
    </in-binding>
    <out-binding>
      <bind name="actionResult" type="Any" explicitly-not-bound="true"/>
    </out-binding>
    <description><![CDATA[Wait a VIM 3 Task to end.
When task ended, return the ]]></description>
    <position y="109.95454545454544" x="844.5"/>
  </workflow-item>
  <workflow-item name="item1" out-name="item7" type="task" script-module="com.vmware.library.vc.vm.power/shutdownVMAndForce">
    <display-name><![CDATA[shutdownVMAndForce]]></display-name>
    <script encoded="false"><![CDATA[//Auto generated script, cannot be modified !
System.getModule("com.vmware.library.vc.vm.power").shutdownVMAndForce(vm,timeout,polling) ;]]></script>
    <in-binding>
      <bind name="vm" type="VC:VirtualMachine" export-name="vm">
        <description><![CDATA[VM to shutdown]]></description>
      </bind>
      <bind name="timeout" type="number" export-name="timeout">
        <description><![CDATA[Timeout to wait before force power off [min]]]></description>
      </bind>
      <bind name="polling" type="number" explicitly-not-bound="true">
        <description><![CDATA[Polling rate [s]]]></description>
      </bind>
    </in-binding>
    <out-binding/>
    <description><![CDATA[Try to shutdown a VM guest. If still not power off after 5 minutes, force power off.]]></description>
    <position y="64.5" x="424.5"/>
  </workflow-item>
  <workflow-item name="item4" out-name="item2" type="task" script-module="com.vmware.library.vc.vm.power/startVM">
    <display-name><![CDATA[startVM]]></display-name>
    <script encoded="false"><![CDATA[//Auto generated script, cannot be modified !
actionResult = System.getModule("com.vmware.library.vc.vm.power").startVM(vm,host) ;]]></script>
    <in-binding>
      <bind name="vm" type="VC:VirtualMachine" export-name="vm">
        <description><![CDATA[VM to start or resume]]></description>
      </bind>
      <bind name="host" type="VC:HostSystem" explicitly-not-bound="true" export-name="NULL">
        <description><![CDATA[[Optional] The host where the virtual machine is to be powered on. If no host is specified, the current associated host is used. This field must specify a host that is part of the same compute resource that the virtual machine is currently associated with. If this host is not compatible, the current host association is used. ]]></description>
      </bind>
      <bind name="task" type="VC:Task" export-name="task">
        <description><![CDATA[Task to await]]></description>
      </bind>
    </in-binding>
    <out-binding>
      <bind name="actionResult" type="VC:Task" explicitly-not-bound="true"/>
    </out-binding>
    <description><![CDATA[Start / Resume a VM. Return the start task]]></description>
    <position y="109.95454545454544" x="1124.5"/>
  </workflow-item>
  <workflow-item name="item5" out-name="item7" type="custom-condition" alt-out-name="item1">
    <display-name><![CDATA[Custom decision]]></display-name>
    <script encoded="false"><![CDATA[return vm.runtime.powerState.value == "poweredOff";]]></script>
    <in-binding>
      <bind name="vm" type="VC:VirtualMachine" export-name="vm"/>
    </in-binding>
    <position y="99.95454545454544" x="424.5"/>
  </workflow-item>
  <workflow-item name="item7" out-name="item0" throw-bind-name="errorCode" type="task" script-module="com.vmware.library.vc.vm/changeVMvCPU">
    <display-name><![CDATA[changeVMvCPU]]></display-name>
    <script encoded="false"><![CDATA[//Auto generated script, cannot be modified !
actionResult = System.getModule("com.vmware.library.vc.vm").changeVMvCPU(vm,vcpu) ;]]></script>
    <in-binding>
      <bind name="vm" type="VC:VirtualMachine" export-name="vm">
        <description><![CDATA[The VM to change]]></description>
      </bind>
      <bind name="vcpu" type="number" export-name="vcpu">
        <description><![CDATA[New vCPU number]]></description>
      </bind>
    </in-binding>
    <out-binding>
      <bind name="actionResult" type="VC:Task" export-name="task"/>
    </out-binding>
    <description><![CDATA[Change the number of vCPUs in the VM.]]></description>
    <position y="109.95454545454544" x="564.5"/>
  </workflow-item>
  <workflow-item name="item0" out-name="item3" throw-bind-name="errorCode" type="task" script-module="com.vmware.library.vc.vm/changeVMRAM">
    <display-name><![CDATA[changeVMRAM]]></display-name>
    <script encoded="false"><![CDATA[//Auto generated script, cannot be modified !
actionResult = System.getModule("com.vmware.library.vc.vm").changeVMRAM(vm,memory) ;]]></script>
    <in-binding>
      <bind name="vm" type="VC:VirtualMachine" export-name="vm">
        <description><![CDATA[The VM to change]]></description>
      </bind>
      <bind name="memory" type="number" export-name="mem">
        <description><![CDATA[New memory value]]></description>
      </bind>
    </in-binding>
    <out-binding>
      <bind name="actionResult" type="VC:Task" export-name="actionResult"/>
    </out-binding>
    <description><![CDATA[Change the VM memory size.]]></description>
    <position y="109.95454545454544" x="704.5"/>
  </workflow-item>
  <workflow-item name="item6" out-name="item4" type="task" script-module="com.vmware.library.vc.basic/vim3WaitTaskEnd">
    <display-name><![CDATA[vim3WaitTaskEnd]]></display-name>
    <script encoded="false"><![CDATA[//Auto generated script, cannot be modified !
actionResult = System.getModule("com.vmware.library.vc.basic").vim3WaitTaskEnd(task,progress,pollRate) ;]]></script>
    <in-binding>
      <bind name="task" type="VC:Task" export-name="actionResult">
        <description><![CDATA[Task to Wait for]]></description>
      </bind>
      <bind name="progress" type="boolean" explicitly-not-bound="true">
        <description><![CDATA[Log progess while waiting for the task]]></description>
      </bind>
      <bind name="pollRate" type="number" explicitly-not-bound="true">
        <description><![CDATA[Polling rate for the task state [seconds]]]></description>
      </bind>
    </in-binding>
    <out-binding>
      <bind name="actionResult" type="Any" explicitly-not-bound="true"/>
    </out-binding>
    <description><![CDATA[Wait a VIM 3 Task to end.
When task ended, return the ]]></description>
    <position y="109.95454545454544" x="984.5"/>
  </workflow-item>
  <workflow-item name="item8" out-name="item5" type="condition" alt-out-name="item11" comparator="0">
    <display-name><![CDATA[Memory Greater than 1GB]]></display-name>
    <script encoded="false"><![CDATA[//Generated by the system, cannot be edited
return (mem >= 1024.0) ;]]></script>
    <in-binding>
      <bind name="mem" type="number" export-name="mem"/>
    </in-binding>
    <condition name="mem" type="number" comparator="5" label="null">1024.0</condition>
    <position y="99.95454545454544" x="284.5"/>
  </workflow-item>
  <workflow-item name="item9" out-name="item8" type="condition" alt-out-name="item10" comparator="0">
    <display-name><![CDATA[vCPU Greater than 0]]></display-name>
    <script encoded="false"><![CDATA[//Generated by the system, cannot be edited
return (vcpu >= 1.0) ;]]></script>
    <in-binding>
      <bind name="vcpu" type="number" export-name="vcpu"/>
    </in-binding>
    <condition name="vcpu" type="number" comparator="5" label="null">1.0</condition>
    <position y="99.95454545454544" x="144.5"/>
  </workflow-item>
  <workflow-item name="item10" business-status="CPU is less than 0" throw-bind-name="NULL" type="end" end-mode="1">
    <position y="163.59090909090907" x="184.5"/>
  </workflow-item>
  <workflow-item name="item11" business-status="Memory is less than 1GB" throw-bind-name="NULL" type="end" end-mode="1">
    <position y="163.59090909090907" x="324.5"/>
  </workflow-item>
  <presentation>
    <p-step>
      <title><![CDATA[Step 1]]></title>
      <p-param name="vm">
        <desc><![CDATA[Virtual machine on which to change the vCPU count]]></desc>
        <p-qual name="mandatory" type="boolean"><![CDATA[true]]></p-qual>
        <p-qual name="contextualParameter" type="void"><![CDATA[]]></p-qual>
      </p-param>
    </p-step>
    <p-step>
      <title><![CDATA[Step 2]]></title>
      <p-param name="vcpu">
        <desc><![CDATA[New vCPU number]]></desc>
        <p-qual kind="static" name="mandatory" type="boolean"><![CDATA[true]]></p-qual>
        <p-qual kind="static" name="genericEnumeration" type="Array/number"><![CDATA[#{#number#1.0#;#number#2.0#;#number#4.0#;#number#6.0#;#number#8.0#;#number#10.0#;#number#12.0#}#]]></p-qual>
      </p-param>
    </p-step>
    <p-param name="mem">
      <desc><![CDATA[mem]]></desc>
    </p-param>
  </presentation>
</workflow>